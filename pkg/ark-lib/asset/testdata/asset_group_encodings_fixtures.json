{
  "asset_refs": {
    "valid": [
      {
        "name": "by_id",
        "type": "AssetRefByID",
        "asset_id": {
          "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
          "index": 4660
        },
        "group_index": 0,
        "serialized_hex": "01aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1234"
      },
      {
        "name": "by_group",
        "type": "AssetRefByGroup",
        "asset_id": null,
        "group_index": 42,
        "serialized_hex": "02002a"
      },
      {
        "name": "by_id_with_extra_group_index",
        "type": "AssetRefByID",
        "asset_id": null,
        "group_index": 10,
        "description": "AssetRefByID but has GroupIndex set - GroupIndex should be ignored on decode"
      },
      {
        "name": "by_group_with_extra_asset_id",
        "type": "AssetRefByGroup",
        "asset_id": {
          "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
          "index": 4660
        },
        "group_index": 0,
        "description": "AssetRefByGroup but has AssetId set - AssetId should be ignored on decode"
      }
    ],
    "invalid": [
      {
        "name": "unknown_type",
        "type_raw": 99,
        "expected_error": "unknown asset ref type: 99"
      }
    ]
  },
  "metadata_lists": [
    {
      "name": "varied",
      "items": [
        { "key": "k1", "value": "v1" },
        { "key": "", "value": "v2" },
        { "key": "v3", "value": "" },
        { "key": "", "value": "" }
      ],
      "serialized_hex": "04026b3102763100027632027633000000"
    },
    {
      "name": "empty",
      "items": [],
      "serialized_hex": "00"
    },
    {
      "name": "single",
      "items": [
        { "key": "testkey", "value": "testvalue" }
      ],
      "serialized_hex": "0107746573746b6579097465737476616c7565"
    }
  ],
  "asset_inputs": {
    "valid": [
      {
        "name": "comprehensive",
        "inputs": [
          { "type": "local", "vin": 3, "amount": 1000 },
          { "type": "local", "vin": 0, "amount": 0 },
          { "type": "intent", "amount": 2000, "txid": "0000000000000000000000000000000000000000000000000000000000000000", "vin": 0 },
          { "type": "intent", "vin": 3, "amount": 2000, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" },
          { "type": "intent", "vin": 42, "amount": 2000, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" },
          { "type": "intent", "vin": 99, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" },
          { "type": "intent", "vin": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" },
          { "type": "intent", "vin": 101, "txid": "0000000000000000000000000000000000000000000000000000000000000000" },
          { "type": "intent", "vin": 4294967295, "txid": "0000000000000000000000000000000000000000000000000000000000000000" }
        ],
        "serialized_hex": "09010000000300000000000003e8010000000000000000000000000200000000000007d00000000000000000000000000000000000000000000000000000000000000000000000000200000000000007d0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000030200000000000007d0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000002a020000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00000063020000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000640200000000000000000000000000000000000000000000000000000000000000000000000000000000000000650200000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff"
      },
      {
        "name": "single_local",
        "inputs": [
          { "type": "local", "vin": 1, "amount": 10 }
        ],
        "serialized_hex": "010100000001000000000000000a"
      },
      {
        "name": "single_intent",
        "inputs": [
          { "type": "intent", "amount": 500, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 77 }
        ],
        "serialized_hex": "010200000000000001f4aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000004d"
      }
    ],
    "invalid": [
      {
        "name": "unknown_type",
        "inputs": [
          { "type": "local", "vin": 3, "amount": 1000 },
          { "type_raw": 10 }
        ],
        "expected_error": "unknown asset input type: 10"
      },
      {
        "name": "unknown_type_first",
        "inputs": [
          { "type_raw": 55 }
        ],
        "expected_error": "unknown asset input type: 55"
      }
    ]
  },
  "asset_outputs": {
    "valid": [
      {
        "name": "comprehensive",
        "outputs": [
          { "type": "local", "vout": 3, "amount": 1000 },
          { "type": "local", "vout": 0, "amount": 0 },
          { "type": "intent", "amount": 2000 },
          { "type": "intent", "amount": 3000 },
          { "type": "intent", "amount": 4000 },
          { "type": "intent", "amount": 0 },
          { "type": "intent", "amount": 1 },
          { "type": "local", "vout": 3, "amount": 2000 },
          { "type": "local", "vout": 0, "amount": 0 },
          { "type": "local", "vout": 1, "amount": 1 },
          { "type": "local", "vout": 0, "amount": 18446744073709551614 },
          { "type": "intent", "amount": 18446744073709551614 },
          { "type": "local", "vout": 4294967295, "amount": 5000 },
          { "type": "intent", "amount": 6000 }
        ],
        "serialized_hex": "0e010000000300000000000003e8010000000000000000000000000200000000000007d0020000000000000bb8020000000000000fa0020000000000000000020000000000000001010000000300000000000007d001000000000000000000000000010000000100000000000000010100000000fffffffffffffffe02fffffffffffffffe01ffffffff0000000000001388020000000000001770"
      },
      {
        "name": "single_local",
        "outputs": [
          { "type": "local", "vout": 1, "amount": 10 }
        ],
        "serialized_hex": "010100000001000000000000000a"
      },
      {
        "name": "single_intent",
        "outputs": [
          { "type": "intent", "amount": 500 }
        ],
        "serialized_hex": "010200000000000001f4"
      },
      {
        "name": "single_intent_zero",
        "outputs": [
          { "type": "intent", "amount": 0 }
        ],
        "serialized_hex": "01020000000000000000"
      }
    ],
    "invalid": [
      {
        "name": "unknown_type",
        "outputs": [
          { "type_raw": 10, "vout": 3, "amount": 1000 }
        ],
        "expected_error": "unknown asset output type: 10"
      },
      {
        "name": "unknown_type_first",
        "outputs": [
          { "type_raw": 77 }
        ],
        "expected_error": "unknown asset output type: 77"
      }
    ]
  },
  "presence_bit_cases": [
    { "name": "none", "asset_id": false, "control": false, "metadata": false, "immutable": false },
    { "name": "assetId", "asset_id": true, "control": false, "metadata": false, "immutable": false },
    { "name": "control", "asset_id": false, "control": true, "metadata": false, "immutable": false },
    { "name": "metadata", "asset_id": false, "control": false, "metadata": true, "immutable": false },
    { "name": "immutable", "asset_id": false, "control": false, "metadata": false, "immutable": true },
    { "name": "assetId_control", "asset_id": true, "control": true, "metadata": false, "immutable": false },
    { "name": "all", "asset_id": true, "control": true, "metadata": true, "immutable": true }
  ],
  "normalize_slices_cases": [
    {
      "name": "non_empty_remains",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 },
      "has_outputs": true,
      "has_inputs": true,
      "has_metadata": true,
      "output": { "type": "local", "amount": 10, "vout": 1 },
      "input": { "type": "local", "vin": 1, "amount": 5 },
      "metadata": { "key": "kind", "value": "normal" }
    },
    {
      "name": "empty_slices_become_nil",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 },
      "has_outputs": false,
      "has_inputs": false,
      "has_metadata": false
    },
    {
      "name": "nil_slices_remain_nil",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 },
      "has_outputs": false,
      "has_inputs": false,
      "has_metadata": false,
      "use_nil": true
    },
    {
      "name": "preserve_elements",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 },
      "has_outputs": true,
      "has_inputs": true,
      "has_metadata": true,
      "output": { "type": "local", "vout": 4, "amount": 44 },
      "input": { "type": "local", "vin": 5, "amount": 55 },
      "metadata": { "key": "a", "value": "b" }
    }
  ],
  "control_asset_refs": [
    {
      "name": "default",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 }
    }
  ],
  "presence_bit_asset_ids": [
    {
      "name": "default",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 0 }
    }
  ],
  "encode_asset_groups": {
    "valid": [
    {
      "name": "full_asset_group",
      "description": "Asset group with all fields populated",
      "asset_groups": [
        {
          "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 1 },
          "immutable": true,
          "control_asset": { "type": "AssetRefByGroup", "group_index": 0 },
          "inputs": [{ "type": "local", "vin": 0, "amount": 100 }],
          "outputs": [{ "type": "local", "vout": 0, "amount": 100 }],
          "metadata": [{ "key": "test", "value": "value" }]
        }
      ],
      "serialized_hex": "010faaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa00010200000104746573740576616c756501010000000000000000000000640101000000000000000000000064"
    },
    {
      "name": "minimal_asset_group",
      "description": "Empty but valid asset group",
      "asset_groups": [{}],
      "serialized_hex": "01000000"
    },
    {
      "name": "intent_assets",
      "description": "Asset group with intent inputs and outputs",
      "asset_groups": [
        {
          "inputs": [
            { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 1 }
          ],
          "outputs": [
            { "type": "intent", "amount": 100 }
          ]
        }
      ],
      "serialized_hex": "010001020000000000000064aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa0000000101020000000000000064"
    }
    ],
    "invalid": [
      {
        "name": "invalid_input_type_first",
        "description": "First asset group has invalid input type",
        "asset_groups": [
          {
            "inputs": [{ "type_raw": 99, "amount": 100 }]
          }
        ],
        "expected_error": "failed to encode asset group: 0"
      },
      {
        "name": "invalid_input_type_second",
        "description": "Second asset group has invalid input type",
        "use_normal_asset_first": true,
        "asset_groups": [
          {
            "inputs": [{ "type_raw": 88, "amount": 100 }]
          }
        ],
        "expected_error": "failed to encode asset group: 1"
      },
      {
        "name": "invalid_output_type",
        "description": "Asset group has invalid output type",
        "asset_groups": [
          {
            "outputs": [{ "type_raw": 77, "amount": 100 }]
          }
        ],
        "expected_error": "failed to encode asset group: 0"
      },
      {
        "name": "invalid_control_asset_type",
        "description": "Asset group has invalid control asset ref type",
        "asset_groups": [
          {
            "control_asset": { "type_raw": 66 }
          }
        ],
        "expected_error": "failed to encode asset group: 0"
      },
      {
        "name": "multiple_valid_then_invalid",
        "description": "Two valid asset groups followed by invalid",
        "use_control_and_normal_first": true,
        "asset_groups": [
          {
            "inputs": [{ "type_raw": 55, "amount": 100 }]
          }
        ],
        "expected_error": "failed to encode asset group: 2"
      }
    ]
  },
  "write_test_data": {
    "asset_ref_by_id": {
      "type": "AssetRefByID",
      "asset_id": { "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "index": 1 }
    },
    "asset_ref_by_group": {
      "type": "AssetRefByGroup",
      "group_index": 42
    },
    "metadata_single": [
      { "key": "testkey", "value": "testvalue" }
    ],
    "metadata_empty_key": [
      { "key": "", "value": "testvalue" }
    ],
    "input_local": { "type": "local", "vin": 1, "amount": 10 },
    "input_intent": { "type": "intent", "amount": 100, "txid": "0000000000000000000000000000000000000000000000000000000000000000", "vin": 0 },
    "input_intent_with_txid": { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 5 },
    "output_local": { "type": "local", "vout": 1, "amount": 10 },
    "output_intent": { "type": "intent", "amount": 100 }
  },
  "intent_truncation_inputs": [
    {
      "name": "truncate_after_amount",
      "description": "Intent input to test truncation after amount field",
      "input": { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 5 },
      "truncate_at": 3
    },
    {
      "name": "truncate_partial_txid",
      "description": "Intent input to test truncation in middle of txid",
      "input": { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 5 },
      "truncate_at": 19
    },
    {
      "name": "truncate_after_txid",
      "description": "Intent input to test truncation after txid but before vin",
      "input": { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 5 },
      "truncate_at": 35
    }
  ],
  "intent_roundtrip_cases": [
    {
      "name": "intent_inputs_only",
      "description": "Asset group with only intent inputs",
      "inputs": [
        { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 1 },
        { "type": "intent", "amount": 200, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 2 }
      ],
      "outputs": [
        { "type": "local", "vout": 0, "amount": 300 }
      ]
    },
    {
      "name": "intent_outputs_only",
      "description": "Asset group with only intent outputs",
      "inputs": [
        { "type": "local", "vin": 0, "amount": 500 }
      ],
      "outputs": [
        { "type": "intent", "amount": 100 },
        { "type": "intent", "amount": 200 },
        { "type": "intent", "amount": 200 }
      ]
    },
    {
      "name": "all_intent",
      "description": "Asset group with all intent inputs and outputs",
      "inputs": [
        { "type": "intent", "amount": 100, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 0 },
        { "type": "intent", "amount": 200, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 1 }
      ],
      "outputs": [
        { "type": "intent", "amount": 150 },
        { "type": "intent", "amount": 150 }
      ]
    },
    {
      "name": "intent_zero_txid",
      "description": "Intent input with zero txid",
      "inputs": [
        { "type": "intent", "amount": 100, "txid": "0000000000000000000000000000000000000000000000000000000000000000", "vin": 0 }
      ],
      "outputs": [
        { "type": "intent", "amount": 100 }
      ]
    },
    {
      "name": "intent_max_vin",
      "description": "Intent input with max uint32 vin",
      "inputs": [
        { "type": "intent", "amount": 100, "txid": "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff", "vin": 4294967295 }
      ],
      "outputs": [
        { "type": "intent", "amount": 100 }
      ]
    },
    {
      "name": "mixed_local_and_intent",
      "description": "Asset group with mixed local and intent types",
      "inputs": [
        { "type": "local", "vin": 0, "amount": 50 },
        { "type": "intent", "amount": 50, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 1 }
      ],
      "outputs": [
        { "type": "local", "vout": 0, "amount": 25 },
        { "type": "intent", "amount": 75 }
      ]
    },
    {
      "name": "intent_extension_packet",
      "description": "Intent asset group for extension packet roundtrip",
      "inputs": [
        { "type": "intent", "amount": 1000, "txid": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "vin": 99 }
      ],
      "outputs": [
        { "type": "intent", "amount": 1000 }
      ]
    }
  ],
  "pub_keys": [
    {
      "name": "subdust_key_0x55",
      "priv_key_bytes": "5555555555555555555555555555555555555555555555555555555555555555"
    }
  ]
}
